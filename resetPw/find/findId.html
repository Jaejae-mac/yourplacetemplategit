<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1, shrink-to-fit=no"
    />
    <meta name="description" content="" />
    <meta name="author" content="" />
    <title>Find My Id - yourplace</title>
    <script
      src="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/js/all.min.js"
      crossorigin="anonymous"
    ></script>
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@10" defer></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/limonte-sweetalert2/10.12.6/sweetalert2.min.js"></script>
    <script src="//code.jquery.com/jquery-3.3.1.min.js"></script>
    <link rel="stylesheet" type="text/css" href="css/test.css" />
    <link rel="stylesheet" href="css/styles.css" />
  </head>
  <style>
    main,
    #layoutAuthentication_content {
      background-color: rgb(255, 255, 255);
    }
    .password:focus,
    .password-confirm:focus {
      outline: none;
    }
  </style>
  <body class="bg-primary">
    <!--body-->
    <!-- Main Body -->
    <div
      style="
        flex-direction: row;
        display: flex;
        justify-content: center;
        background-color: white;
        margin-top: 100px;
      "
    >
      <!-- header 가 100px 이라 margin-top = header height-->
      <div class="h_center" id="test_body" style="width: 1160px; height: 100%">
        <div style="position: absolute; width: 100%; height: 100%"></div>
        <div
          id="main"
          class="h_column_center"
          style="width: 100%; margin-top: 50px; margin-bottom: 200px"
        >
          <div class="h_column_center" style="margin-top: 20px">
            <p
              style="
                font-size: 32px;
                font-weight: bold;
                font-stretch: normal;
                font-style: normal;
                line-height: 1.31;
                letter-spacing: -0.3px;
                text-align: center;
                color: #1b1d1f;
              "
            >
              아이디 찾기
            </p>
          </div>

          <div
            id="main_vue"
            class="h_column_center"
            style="width: 100%; margin-top: 30px; margin-bottom: 200px"
            v-cloak
          >
            <div
              style="
                width: 580px;
                border-radius: 10px;
                border: solid 1px #dfe2e7;
                background-color: #ffffff;
                padding: 40px 50px;
              "
            >
              <div class="h_column_center" v-show="step === 0">
                <!-- password 재설정 -->
                <div
								style="border-radius: 15px; background-color: rgb(0, 0, 0, 0.1); margin-bottom: 10px;">
								<p
									style="font-style: normal; font-weight: bold; font-size: 13px; line-height: 26px; text-align: left; letter-spacing: -0.1px; color: #1b1d1f; margin: 8px 40px;">
									가입시 등록하신 전화번호를 통해 인증 후 아이디 찾기가 가능합니다.</p>
							</div>
                <form
                  id="form_findpassword"
                  method="POST"
                  action="/reset/password"
                  style="width: 100%"
                >
                  <div class="h_row" style="margin-top: 20px">
                    <p
                      style="
                        margin-bottom: 0;
                        font-size: 12px;
                        font-weight: bold;
                        font-stretch: normal;
                        font-style: normal;
                        line-height: 1.17;
                        letter-spacing: normal;
                        color: var(--grey-040);
                      "
                    >
                      본인 인증
                    </p>
                  </div>
                  <div
                    class="input_container disabled"
                    style="margin-top: 8px; cursor: pointer; width: 100%"
                    size="500"
                  >
                    <!-- 인증기능 페이지로 이동-->
                    <input
                      type="phone"
                      placeholder="본인인증을 진행해 주세요"
                      model="nice_auth"
                      id="userPhoneNum"
                      required
                    />
                    <div
                      class="h_center"
                      style="
                        position: absolute;
                        right: 7px;
                        padding-right: 18px;
                        padding-left: 18px;
                        height: 38px;
                        border-radius: 4px;
                        background-color: var(--grey-070);
                      "
                    >
                      <label
                        for="tel"
                        style="
                          margin-bottom: 0;
                          font-size: 14px;
                          font-weight: 500;
                          font-stretch: normal;
                          font-style: normal;
                          line-height: 1.29;
                          letter-spacing: normal;
                          color: #ffffff;
                        "
                      >
                        휴대폰 인증
                      </label>
                      <input
                        type="button"
                        id="tel"
                        name="userTel"
                        style="display: none"
                      />
                    </div>
                  </div>

                  <div style="height: 50px;"></div>
                  </div>
                </form>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
    <script>
      $(document).on("click", "#tel", function () {
        var userTel = $("#userPhoneNum").val();
        console.log(userTel);
        var authNum;
        if (userTel != "") {
          //beging userTel emptyCheck
          let timerInterval;
          Swal.fire({
            title: "인증번호 입력",
            html:
              "I will close in <b></b> milliseconds." +
              '<br/><br/><input type="text" placeholder="number" id="auth_num" class="form-control">' +
              '<br/><input type="button" class="btn btn-primary" id="auth_num_btn" style="widht:100%;" value="인증 확인">',
            timer: 1000 * 60 * 3,
            timerProgressBar: true,
            didOpen: () => {
              Swal.showLoading();
              const b = Swal.getHtmlContainer().querySelector("b");
              timerInterval = setInterval(() => {
                b.textContent = Swal.getTimerLeft();
              }, 100);
            },
            willClose: () => {
              clearInterval(timerInterval);
            },
          }).then((result) => {
            /* Read more about handling dismissals below */
            if (result.dismiss === Swal.DismissReason.timer) {
              console.log("I was closed by the timer");
            }
          });
          //서버로 전화번호 전송.
          // $.ajax({
          //   url: "/authentication.do",
          //   type: "get",
          //   data: { userTel: userTel },
          //   success: function (responseData) {
          //     authNum = responseData;
          //   },
          // });
        } //end userTel empty Check

        //인증번호 입력후 확인 버튼 클릭 시.
        $(document).on("click", "#auth_num_btn", function () {
          var userAuthNum = $("#auth_num").val();
          swal.close();
          if (authNum === userAuthNum) {
            console.log("전달받은 인증번호 : " + authNum);
            console.log("사용자   인증번호 : " + userAuthNum);
            Swal.fire({
              icon: "success",
              title: "인증번호 일치합니다.",
            });
            locasation.href="/find/account/restlt.do";
          } else {
            Swal.fire({
              icon: "error",
              title: "인증번호가 일치하지 않습니다.",
              text: "다시 인증해주세요.",
            });
            console.log("다릅니다.");
          }
        });
      });
    </script>
  </body>
</html>
